/home/qiu/anaconda3/envs/NOMA/bin/python /home/qiu/Ê°åÈù¢/python/NOMA/rl4co/main.py 
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning_utilities/core/imports.py:14: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  import pkg_resources
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: Deprecated call to `pkg_resources.declare_namespace('lightning.fabric')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/pkg_resources/__init__.py:2317: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('lightning')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(parent)
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/__init__.py:37: Deprecated call to `pkg_resources.declare_namespace('lightning.pytorch')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/pkg_resources/__init__.py:2317: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('lightning')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(parent)
wandb: Currently logged in as: rubbin2004. Use `wandb login --relogin` to force relogin
###NOMAInitEmbedding###
###NOMAContext###
my GNN
###NOMADynamicEmbedding###
my critic network
my GNN
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/utilities/parsing.py:208: Attribute 'env' is an instance of `nn.Module` and is already saved during checkpointing. It is recommended to ignore them using `self.save_hyperparameters(ignore=['env'])`.
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/utilities/parsing.py:208: Attribute 'policy' is an instance of `nn.Module` and is already saved during checkpointing. It is recommended to ignore them using `self.save_hyperparameters(ignore=['policy'])`.
/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/utilities/parsing.py:208: Attribute 'critic' is an instance of `nn.Module` and is already saved during checkpointing. It is recommended to ignore them using `self.save_hyperparameters(ignore=['critic'])`.
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Overriding gradient_clip_val to None for 'automatic_optimization=False' models
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in ./wandb/run-20240810_181704-9l1m1kgl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-fire-44
wandb: ‚≠êÔ∏è View project at https://wandb.ai/rubbin2004/NOMA
wandb: üöÄ View run at https://wandb.ai/rubbin2004/NOMA/runs/9l1m1kgl
val_file not set. Generating dataset instead
test_file not set. Generating dataset instead
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name   | Type                 | Params | Mode 
--------------------------------------------------------
0 | env    | NOMAenv              | 0      | train
1 | policy | AttentionModelPolicy | 3.8 M  | train
2 | critic | MyCriticNetwork      | 74.5 K | train
--------------------------------------------------------
3.9 M     Trainable params
0         Non-trainable params
3.9 M     Total params
15.597    Total estimated model params size (MB)
Sanity Checking: |          | 0/? [00:00<?, ?it/s]/home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/qiu/anaconda3/envs/NOMA/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.
adv mean: tensor(-0.4998, device='cuda:0') adv std: tensor(0.0197, device='cuda:0')
adv mean: tensor(-0.4741, device='cuda:0') adv std: tensor(0.0121, device='cuda:0')
adv mean: tensor(-0.4243, device='cuda:0') adv std: tensor(0.0186, device='cuda:0')
adv mean: tensor(-0.4045, device='cuda:0') adv std: tensor(0.0214, device='cuda:0')
adv mean: tensor(-0.3674, device='cuda:0') adv std: tensor(0.0197, device='cuda:0')
adv mean: tensor(-0.3434, device='cuda:0') adv std: tensor(0.0209, device='cuda:0')
adv mean: tensor(-0.3054, device='cuda:0') adv std: tensor(0.0198, device='cuda:0')
adv mean: tensor(-0.2777, device='cuda:0') adv std: tensor(0.0198, device='cuda:0')
Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.07it/s, v_num=1kgl, train/entropy=25.10, train/loss=0.243, train/surrogate_loss=0.223, train/value_loss=0.0388]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.72it/s]
Epoch 1:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.10, train/loss=0.243, train/surrogate_loss=0.223, train/value_loss=0.0388, val/reward=-0.0113]adv mean: tensor(-0.2342, device='cuda:0') adv std: tensor(0.0150, device='cuda:0')
adv mean: tensor(-0.1985, device='cuda:0') adv std: tensor(0.0269, device='cuda:0')
adv mean: tensor(-0.1667, device='cuda:0') adv std: tensor(0.0210, device='cuda:0')
adv mean: tensor(-0.1296, device='cuda:0') adv std: tensor(0.0207, device='cuda:0')
adv mean: tensor(-0.0876, device='cuda:0') adv std: tensor(0.0215, device='cuda:0')
adv mean: tensor(-0.0630, device='cuda:0') adv std: tensor(0.0222, device='cuda:0')
adv mean: tensor(-0.0310, device='cuda:0') adv std: tensor(0.0183, device='cuda:0')
adv mean: tensor(-0.0069, device='cuda:0') adv std: tensor(0.0238, device='cuda:0')
Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=25.50, train/loss=0.00479, train/surrogate_loss=0.00464, train/value_loss=0.00029, val/reward=-0.0113]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.56it/s]
Epoch 2:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.50, train/loss=0.00479, train/surrogate_loss=0.00464, train/value_loss=0.00029, val/reward=-0.0144]adv mean: tensor(0.0350, device='cuda:0') adv std: tensor(0.0213, device='cuda:0')
adv mean: tensor(0.0483, device='cuda:0') adv std: tensor(0.0208, device='cuda:0')
adv mean: tensor(0.0583, device='cuda:0') adv std: tensor(0.0245, device='cuda:0')
adv mean: tensor(0.0686, device='cuda:0') adv std: tensor(0.0209, device='cuda:0')
adv mean: tensor(0.0757, device='cuda:0') adv std: tensor(0.0197, device='cuda:0')
adv mean: tensor(0.0749, device='cuda:0') adv std: tensor(0.0169, device='cuda:0')
adv mean: tensor(0.0795, device='cuda:0') adv std: tensor(0.0243, device='cuda:0')
adv mean: tensor(0.0788, device='cuda:0') adv std: tensor(0.0247, device='cuda:0')
Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.31it/s, v_num=1kgl, train/entropy=25.50, train/loss=-0.0802, train/surrogate_loss=-0.0819, train/value_loss=0.00339, val/reward=-0.0144]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.53it/s]
Epoch 3:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.50, train/loss=-0.0802, train/surrogate_loss=-0.0819, train/value_loss=0.00339, val/reward=-0.0144]adv mean: tensor(0.0596, device='cuda:0') adv std: tensor(0.0180, device='cuda:0')
adv mean: tensor(0.0541, device='cuda:0') adv std: tensor(0.0239, device='cuda:0')
adv mean: tensor(0.0408, device='cuda:0') adv std: tensor(0.0200, device='cuda:0')
adv mean: tensor(0.0353, device='cuda:0') adv std: tensor(0.0222, device='cuda:0')
adv mean: tensor(0.0159, device='cuda:0') adv std: tensor(0.0180, device='cuda:0')
adv mean: tensor(-0.0009, device='cuda:0') adv std: tensor(0.0226, device='cuda:0')
adv mean: tensor(-0.0259, device='cuda:0') adv std: tensor(0.0192, device='cuda:0')
adv mean: tensor(-0.0220, device='cuda:0') adv std: tensor(0.0198, device='cuda:0')
Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=25.50, train/loss=0.0256, train/surrogate_loss=0.0254, train/value_loss=0.000426, val/reward=-0.0144] 
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.63it/s]
Epoch 4:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.50, train/loss=0.0256, train/surrogate_loss=0.0254, train/value_loss=0.000426, val/reward=-0.0134]adv mean: tensor(-0.0367, device='cuda:0') adv std: tensor(0.0210, device='cuda:0')
adv mean: tensor(-0.0294, device='cuda:0') adv std: tensor(0.0176, device='cuda:0')
adv mean: tensor(-0.0302, device='cuda:0') adv std: tensor(0.0187, device='cuda:0')
adv mean: tensor(-0.0312, device='cuda:0') adv std: tensor(0.0171, device='cuda:0')
adv mean: tensor(-0.0233, device='cuda:0') adv std: tensor(0.0226, device='cuda:0')
adv mean: tensor(-0.0171, device='cuda:0') adv std: tensor(0.0163, device='cuda:0')
adv mean: tensor(-0.0070, device='cuda:0') adv std: tensor(0.0150, device='cuda:0')
adv mean: tensor(0.0061, device='cuda:0') adv std: tensor(0.0191, device='cuda:0')
Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.30it/s, v_num=1kgl, train/entropy=25.50, train/loss=-0.00617, train/surrogate_loss=-0.00626, train/value_loss=0.000189, val/reward=-0.0134]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.36it/s]
Epoch 5:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.50, train/loss=-0.00617, train/surrogate_loss=-0.00626, train/value_loss=0.000189, val/reward=-0.0127]adv mean: tensor(0.0228, device='cuda:0') adv std: tensor(0.0180, device='cuda:0')
adv mean: tensor(0.0099, device='cuda:0') adv std: tensor(0.0155, device='cuda:0')
adv mean: tensor(0.0069, device='cuda:0') adv std: tensor(0.0202, device='cuda:0')
adv mean: tensor(0.0064, device='cuda:0') adv std: tensor(0.0164, device='cuda:0')
adv mean: tensor(0.0046, device='cuda:0') adv std: tensor(0.0178, device='cuda:0')
adv mean: tensor(6.1870e-05, device='cuda:0') adv std: tensor(0.0181, device='cuda:0')
adv mean: tensor(0.0037, device='cuda:0') adv std: tensor(0.0181, device='cuda:0')
adv mean: tensor(0.0039, device='cuda:0') adv std: tensor(0.0155, device='cuda:0')
Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=25.40, train/loss=-0.00411, train/surrogate_loss=-0.00417, train/value_loss=0.000121, val/reward=-0.0127]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.76it/s]
Epoch 6:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.40, train/loss=-0.00411, train/surrogate_loss=-0.00417, train/value_loss=0.000121, val/reward=-0.0128]adv mean: tensor(0.0008, device='cuda:0') adv std: tensor(0.0160, device='cuda:0')
adv mean: tensor(-0.0102, device='cuda:0') adv std: tensor(0.0190, device='cuda:0')
adv mean: tensor(-0.0106, device='cuda:0') adv std: tensor(0.0144, device='cuda:0')
adv mean: tensor(-0.0201, device='cuda:0') adv std: tensor(0.0163, device='cuda:0')
adv mean: tensor(-0.0095, device='cuda:0') adv std: tensor(0.0130, device='cuda:0')
adv mean: tensor(-0.0182, device='cuda:0') adv std: tensor(0.0181, device='cuda:0')
adv mean: tensor(-0.0066, device='cuda:0') adv std: tensor(0.0166, device='cuda:0')
adv mean: tensor(-0.0001, device='cuda:0') adv std: tensor(0.0137, device='cuda:0')
Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.30it/s, v_num=1kgl, train/entropy=25.60, train/loss=0.00103, train/surrogate_loss=0.000981, train/value_loss=8.83e-5, val/reward=-0.0128]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.04it/s]
Epoch 7:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.60, train/loss=0.00103, train/surrogate_loss=0.000981, train/value_loss=8.83e-5, val/reward=-0.0117]adv mean: tensor(0.0028, device='cuda:0') adv std: tensor(0.0115, device='cuda:0')
adv mean: tensor(0.0078, device='cuda:0') adv std: tensor(0.0149, device='cuda:0')
adv mean: tensor(0.0067, device='cuda:0') adv std: tensor(0.0123, device='cuda:0')
adv mean: tensor(-0.0050, device='cuda:0') adv std: tensor(0.0163, device='cuda:0')
adv mean: tensor(0.0013, device='cuda:0') adv std: tensor(0.0120, device='cuda:0')
adv mean: tensor(-0.0067, device='cuda:0') adv std: tensor(0.0177, device='cuda:0')
adv mean: tensor(0.0052, device='cuda:0') adv std: tensor(0.0107, device='cuda:0')
adv mean: tensor(0.0005, device='cuda:0') adv std: tensor(0.0104, device='cuda:0')
Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=25.20, train/loss=-0.00176, train/surrogate_loss=-0.00179, train/value_loss=5.11e-5, val/reward=-0.0117]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.72it/s]
Epoch 8:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.20, train/loss=-0.00176, train/surrogate_loss=-0.00179, train/value_loss=5.11e-5, val/reward=-0.011]adv mean: tensor(-0.0022, device='cuda:0') adv std: tensor(0.0126, device='cuda:0')
adv mean: tensor(-0.0037, device='cuda:0') adv std: tensor(0.0152, device='cuda:0')
adv mean: tensor(0.0090, device='cuda:0') adv std: tensor(0.0143, device='cuda:0')
adv mean: tensor(0.0066, device='cuda:0') adv std: tensor(0.0107, device='cuda:0')
adv mean: tensor(0.0088, device='cuda:0') adv std: tensor(0.0132, device='cuda:0')
adv mean: tensor(0.0071, device='cuda:0') adv std: tensor(0.0129, device='cuda:0')
adv mean: tensor(-0.0013, device='cuda:0') adv std: tensor(0.0143, device='cuda:0')
adv mean: tensor(-0.0071, device='cuda:0') adv std: tensor(0.0087, device='cuda:0')
Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.32it/s, v_num=1kgl, train/entropy=25.30, train/loss=0.00596, train/surrogate_loss=0.00593, train/value_loss=6.07e-5, val/reward=-0.011]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.23it/s]
Epoch 9:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.30, train/loss=0.00596, train/surrogate_loss=0.00593, train/value_loss=6.07e-5, val/reward=-0.0101]adv mean: tensor(-0.0014, device='cuda:0') adv std: tensor(0.0097, device='cuda:0')
adv mean: tensor(-0.0006, device='cuda:0') adv std: tensor(0.0129, device='cuda:0')
adv mean: tensor(0.0077, device='cuda:0') adv std: tensor(0.0113, device='cuda:0')
adv mean: tensor(-0.0004, device='cuda:0') adv std: tensor(0.0109, device='cuda:0')
adv mean: tensor(0.0099, device='cuda:0') adv std: tensor(0.0100, device='cuda:0')
adv mean: tensor(0.0030, device='cuda:0') adv std: tensor(0.0132, device='cuda:0')
adv mean: tensor(0.0005, device='cuda:0') adv std: tensor(0.0109, device='cuda:0')
adv mean: tensor(0.0011, device='cuda:0') adv std: tensor(0.0100, device='cuda:0')
Epoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.25it/s, v_num=1kgl, train/entropy=25.10, train/loss=-0.00208, train/surrogate_loss=-0.00211, train/value_loss=4.78e-5, val/reward=-0.0101]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.40it/s]
Epoch 10:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=25.10, train/loss=-0.00208, train/surrogate_loss=-0.00211, train/value_loss=4.78e-5, val/reward=-0.00944]adv mean: tensor(-0.0055, device='cuda:0') adv std: tensor(0.0072, device='cuda:0')
adv mean: tensor(0.0043, device='cuda:0') adv std: tensor(0.0084, device='cuda:0')
adv mean: tensor(0.0034, device='cuda:0') adv std: tensor(0.0148, device='cuda:0')
adv mean: tensor(0.0146, device='cuda:0') adv std: tensor(0.0101, device='cuda:0')
adv mean: tensor(0.0098, device='cuda:0') adv std: tensor(0.0134, device='cuda:0')
adv mean: tensor(0.0059, device='cuda:0') adv std: tensor(0.0098, device='cuda:0')
adv mean: tensor(4.2528e-05, device='cuda:0') adv std: tensor(0.0090, device='cuda:0')
adv mean: tensor(-0.0015, device='cuda:0') adv std: tensor(0.0094, device='cuda:0')
Epoch 10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.30it/s, v_num=1kgl, train/entropy=24.20, train/loss=0.00107, train/surrogate_loss=0.00105, train/value_loss=4.23e-5, val/reward=-0.00944]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.03it/s]
Epoch 11:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.20, train/loss=0.00107, train/surrogate_loss=0.00105, train/value_loss=4.23e-5, val/reward=-0.00839]adv mean: tensor(-0.0085, device='cuda:0') adv std: tensor(0.0091, device='cuda:0')
adv mean: tensor(-0.0046, device='cuda:0') adv std: tensor(0.0131, device='cuda:0')
adv mean: tensor(0.0033, device='cuda:0') adv std: tensor(0.0082, device='cuda:0')
adv mean: tensor(0.0094, device='cuda:0') adv std: tensor(0.0102, device='cuda:0')
adv mean: tensor(0.0041, device='cuda:0') adv std: tensor(0.0124, device='cuda:0')
adv mean: tensor(0.0089, device='cuda:0') adv std: tensor(0.0100, device='cuda:0')
adv mean: tensor(0.0025, device='cuda:0') adv std: tensor(0.0071, device='cuda:0')
adv mean: tensor(-0.0020, device='cuda:0') adv std: tensor(0.0101, device='cuda:0')
Epoch 11: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=24.60, train/loss=0.00126, train/surrogate_loss=0.00123, train/value_loss=4.97e-5, val/reward=-0.00839]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.60it/s]
Epoch 12:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.60, train/loss=0.00126, train/surrogate_loss=0.00123, train/value_loss=4.97e-5, val/reward=-0.00916]adv mean: tensor(-0.0022, device='cuda:0') adv std: tensor(0.0074, device='cuda:0')
adv mean: tensor(-0.0028, device='cuda:0') adv std: tensor(0.0083, device='cuda:0')
adv mean: tensor(0.0034, device='cuda:0') adv std: tensor(0.0107, device='cuda:0')
adv mean: tensor(0.0054, device='cuda:0') adv std: tensor(0.0125, device='cuda:0')
adv mean: tensor(0.0065, device='cuda:0') adv std: tensor(0.0083, device='cuda:0')
adv mean: tensor(0.0056, device='cuda:0') adv std: tensor(0.0113, device='cuda:0')
adv mean: tensor(0.0028, device='cuda:0') adv std: tensor(0.0099, device='cuda:0')
adv mean: tensor(0.0019, device='cuda:0') adv std: tensor(0.0093, device='cuda:0')
Epoch 12: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.32it/s, v_num=1kgl, train/entropy=24.70, train/loss=-0.00237, train/surrogate_loss=-0.00239, train/value_loss=4.23e-5, val/reward=-0.00916]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.45it/s]
Epoch 13:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.70, train/loss=-0.00237, train/surrogate_loss=-0.00239, train/value_loss=4.23e-5, val/reward=-0.00888]adv mean: tensor(-0.0043, device='cuda:0') adv std: tensor(0.0086, device='cuda:0')
adv mean: tensor(-0.0008, device='cuda:0') adv std: tensor(0.0081, device='cuda:0')
adv mean: tensor(0.0042, device='cuda:0') adv std: tensor(0.0067, device='cuda:0')
adv mean: tensor(0.0028, device='cuda:0') adv std: tensor(0.0084, device='cuda:0')
adv mean: tensor(0.0046, device='cuda:0') adv std: tensor(0.0054, device='cuda:0')
adv mean: tensor(0.0051, device='cuda:0') adv std: tensor(0.0067, device='cuda:0')
adv mean: tensor(0.0026, device='cuda:0') adv std: tensor(0.0091, device='cuda:0')
adv mean: tensor(-0.0072, device='cuda:0') adv std: tensor(0.0080, device='cuda:0')
Epoch 13: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.27it/s, v_num=1kgl, train/entropy=24.50, train/loss=0.00636, train/surrogate_loss=0.00633, train/value_loss=5.53e-5, val/reward=-0.00888]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.43it/s]
Epoch 14:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.50, train/loss=0.00636, train/surrogate_loss=0.00633, train/value_loss=5.53e-5, val/reward=-0.0094]adv mean: tensor(-0.0045, device='cuda:0') adv std: tensor(0.0065, device='cuda:0')
adv mean: tensor(0.0047, device='cuda:0') adv std: tensor(0.0064, device='cuda:0')
adv mean: tensor(0.0104, device='cuda:0') adv std: tensor(0.0099, device='cuda:0')
adv mean: tensor(0.0122, device='cuda:0') adv std: tensor(0.0123, device='cuda:0')
adv mean: tensor(0.0142, device='cuda:0') adv std: tensor(0.0075, device='cuda:0')
adv mean: tensor(0.0097, device='cuda:0') adv std: tensor(0.0076, device='cuda:0')
adv mean: tensor(0.0036, device='cuda:0') adv std: tensor(0.0103, device='cuda:0')
adv mean: tensor(-4.7028e-05, device='cuda:0') adv std: tensor(0.0098, device='cuda:0')
Epoch 14: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.31it/s, v_num=1kgl, train/entropy=24.20, train/loss=-0.00092, train/surrogate_loss=-0.000942, train/value_loss=4.54e-5, val/reward=-0.0094]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.39it/s]
Epoch 15:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.20, train/loss=-0.00092, train/surrogate_loss=-0.000942, train/value_loss=4.54e-5, val/reward=-0.00972]adv mean: tensor(-0.0085, device='cuda:0') adv std: tensor(0.0064, device='cuda:0')
adv mean: tensor(-0.0044, device='cuda:0') adv std: tensor(0.0093, device='cuda:0')
adv mean: tensor(-0.0026, device='cuda:0') adv std: tensor(0.0081, device='cuda:0')
adv mean: tensor(0.0014, device='cuda:0') adv std: tensor(0.0076, device='cuda:0')
adv mean: tensor(0.0092, device='cuda:0') adv std: tensor(0.0062, device='cuda:0')
adv mean: tensor(0.0095, device='cuda:0') adv std: tensor(0.0061, device='cuda:0')
adv mean: tensor(-0.0033, device='cuda:0') adv std: tensor(0.0081, device='cuda:0')
adv mean: tensor(0.0039, device='cuda:0') adv std: tensor(0.0057, device='cuda:0')
Epoch 15: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=24.40, train/loss=-0.00409, train/surrogate_loss=-0.0041, train/value_loss=2.27e-5, val/reward=-0.00972]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.65it/s]
Epoch 16:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.40, train/loss=-0.00409, train/surrogate_loss=-0.0041, train/value_loss=2.27e-5, val/reward=-0.00921]adv mean: tensor(0.0014, device='cuda:0') adv std: tensor(0.0080, device='cuda:0')
adv mean: tensor(-0.0025, device='cuda:0') adv std: tensor(0.0070, device='cuda:0')
adv mean: tensor(-0.0047, device='cuda:0') adv std: tensor(0.0064, device='cuda:0')
adv mean: tensor(-0.0109, device='cuda:0') adv std: tensor(0.0086, device='cuda:0')
adv mean: tensor(-0.0090, device='cuda:0') adv std: tensor(0.0088, device='cuda:0')
adv mean: tensor(-0.0078, device='cuda:0') adv std: tensor(0.0050, device='cuda:0')
adv mean: tensor(-8.2910e-05, device='cuda:0') adv std: tensor(0.0100, device='cuda:0')
adv mean: tensor(0.0033, device='cuda:0') adv std: tensor(0.0044, device='cuda:0')
Epoch 16: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.31it/s, v_num=1kgl, train/entropy=24.00, train/loss=-0.00287, train/surrogate_loss=-0.00288, train/value_loss=1.47e-5, val/reward=-0.00921]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.30it/s]
Epoch 17:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=24.00, train/loss=-0.00287, train/surrogate_loss=-0.00288, train/value_loss=1.47e-5, val/reward=-0.00924]adv mean: tensor(0.0089, device='cuda:0') adv std: tensor(0.0062, device='cuda:0')
adv mean: tensor(-0.0004, device='cuda:0') adv std: tensor(0.0098, device='cuda:0')
adv mean: tensor(-0.0040, device='cuda:0') adv std: tensor(0.0052, device='cuda:0')
adv mean: tensor(-0.0117, device='cuda:0') adv std: tensor(0.0102, device='cuda:0')
adv mean: tensor(-0.0088, device='cuda:0') adv std: tensor(0.0080, device='cuda:0')
adv mean: tensor(-0.0064, device='cuda:0') adv std: tensor(0.0056, device='cuda:0')
adv mean: tensor(-0.0063, device='cuda:0') adv std: tensor(0.0088, device='cuda:0')
adv mean: tensor(0.0002, device='cuda:0') adv std: tensor(0.0096, device='cuda:0')
Epoch 17: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=23.90, train/loss=-0.00073, train/surrogate_loss=-0.000751, train/value_loss=4.28e-5, val/reward=-0.00924]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 21.76it/s]
Epoch 18:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=23.90, train/loss=-0.00073, train/surrogate_loss=-0.000751, train/value_loss=4.28e-5, val/reward=-0.00959]adv mean: tensor(0.0053, device='cuda:0') adv std: tensor(0.0067, device='cuda:0')
adv mean: tensor(0.0042, device='cuda:0') adv std: tensor(0.0078, device='cuda:0')
adv mean: tensor(-0.0040, device='cuda:0') adv std: tensor(0.0072, device='cuda:0')
adv mean: tensor(-0.0042, device='cuda:0') adv std: tensor(0.0053, device='cuda:0')
adv mean: tensor(-0.0053, device='cuda:0') adv std: tensor(0.0072, device='cuda:0')
adv mean: tensor(-0.0050, device='cuda:0') adv std: tensor(0.0056, device='cuda:0')
adv mean: tensor(-0.0020, device='cuda:0') adv std: tensor(0.0081, device='cuda:0')
adv mean: tensor(0.0007, device='cuda:0') adv std: tensor(0.0060, device='cuda:0')
Epoch 18: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.30it/s, v_num=1kgl, train/entropy=23.90, train/loss=-0.00116, train/surrogate_loss=-0.00117, train/value_loss=1.7e-5, val/reward=-0.00959]  
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 20.94it/s]
Epoch 19:   0%|          | 0/1 [00:00<?, ?it/s, v_num=1kgl, train/entropy=23.90, train/loss=-0.00116, train/surrogate_loss=-0.00117, train/value_loss=1.7e-5, val/reward=-0.00746]adv mean: tensor(0.0052, device='cuda:0') adv std: tensor(0.0068, device='cuda:0')
adv mean: tensor(-0.0007, device='cuda:0') adv std: tensor(0.0081, device='cuda:0')
adv mean: tensor(-0.0043, device='cuda:0') adv std: tensor(0.0065, device='cuda:0')
adv mean: tensor(-0.0100, device='cuda:0') adv std: tensor(0.0052, device='cuda:0')
adv mean: tensor(-0.0101, device='cuda:0') adv std: tensor(0.0062, device='cuda:0')
adv mean: tensor(-0.0066, device='cuda:0') adv std: tensor(0.0056, device='cuda:0')
adv mean: tensor(-0.0031, device='cuda:0') adv std: tensor(0.0070, device='cuda:0')
adv mean: tensor(0.0011, device='cuda:0') adv std: tensor(0.0077, device='cuda:0')
Epoch 19: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.26it/s, v_num=1kgl, train/entropy=24.30, train/loss=-0.00141, train/surrogate_loss=-0.00142, train/value_loss=2.82e-5, val/reward=-0.00746]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 19.70it/s]
Epoch 19: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  1.04it/s, v_num=1kgl, train/entropy=24.30, train/loss=-0.00141, train/surrogate_loss=-0.00142, train/value_loss=2.82e-5, val/reward=-0.00629]
`Trainer.fit` stopped: `max_epochs=20` reached.
{'reward': tensor([-0.0029, -0.0078]), 'log_likelihood': tensor([-17.9978, -18.4683], grad_fn=<SumBackward1>), 'actions': tensor([[ 18,   5,  47, 118,  59, 106,  95,  71,  82,  35],
        [ 18,   5,  47, 118,  32, 106,  70,  59,  95,  82]])}
wandb: 
wandb: Run history:
wandb:                epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:        train/entropy ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñá‚ñà‚ñá‚ñá‚ñÜ‚ñÇ‚ñÑ‚ñÑ‚ñÑ‚ñÇ‚ñÉ‚ñÇ‚ñÅ‚ñÅ‚ñÇ
wandb:           train/loss ‚ñà‚ñÉ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ
wandb: train/surrogate_loss ‚ñà‚ñÉ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ
wandb:     train/value_loss ‚ñà‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:  trainer/global_step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:           val/reward ‚ñÑ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñá‚ñà
wandb: 
wandb: Run summary:
wandb:                epoch 19
wandb:        train/entropy 24.26237
wandb:           train/loss -0.00141
wandb: train/surrogate_loss -0.00142
wandb:     train/value_loss 3e-05
wandb:  trainer/global_step 19
wandb:           val/reward -0.00629
wandb: 
wandb: üöÄ View run quiet-fire-44 at: https://wandb.ai/rubbin2004/NOMA/runs/9l1m1kgl
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/rubbin2004/NOMA
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240810_181704-9l1m1kgl/logs

Process finished with exit code 0
